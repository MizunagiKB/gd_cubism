# SPDX-License-Identifier: MIT
# SPDX-FileCopyrightText: 2023 MizunagiKB <mizukb@live.jp>
import os
import glob
import shutil


env = Environment(ENV={"PATH": os.environ["PATH"]})


def collect_page():
    for src_pathname in glob.glob("./demo/addons/gd_cubism/res/shader/*.gdshader"):
        _, filename = os.path.split(src_pathname)
        env.Command(
            source=src_pathname,
            target=os.path.join("./docs/modules/ROOT/examples", filename),
            action=[Copy("$TARGET", "$SOURCE")],
        )


def build():
    env.Command(target="DUMMY", source=None, action=[Delete("./docs-site/public")])
    env.Command(
        source="./docs-site/antora-playbook.yml",
        target="./docs-site/public",
        action=["antora --fetch $SOURCE"],
    )


collect_page()
build()
